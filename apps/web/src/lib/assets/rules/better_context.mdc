---
description: Use btca to fetch up-to-date answers about external libraries/frameworks by searching their official repos locally (source-first, no web browsing).
alwaysApply: true
---

# btca – Better Context Agent

btca queries local clones of library/framework repositories to answer questions with up-to-date, source-first information. Use it instead of web searches when the user needs accurate, current details about technologies.

## When to Use btca

- User asks "how does X work in Svelte 5?" or similar framework/library questions
- User needs current API behavior that may differ from your training data
- User explicitly says "use btca" or references a configured resource
- You need to verify syntax or patterns for a specific library version

## Agent Behavior

- **Prefer `btca ask`** over the interactive TUI (agents can't operate TUIs reliably)
- **Ask for missing information** – if the user wants to add/change resources or models but doesn't provide all required details, ask them before running commands
- Run `btca config resources list` first if you're unsure which resources are available

---

- If unsure what's configured: `btca config resources list`
- If missing: add it with `btca config resources add --name svelte --type git --url https://github.com/sveltejs/svelte --branch main`

### `btca ask` (Primary Command for Agents)

- `btca ask --resource <resource> --question '<question>'`
- For multiple resources: `btca ask --resource svelte --resource effect --question '<question>'`
- You can also use @mentions in the question: `btca ask --question 'How do @svelte stores work?'`

| Flag                       | Required | Description                                                                  |
| -------------------------- | -------- | ---------------------------------------------------------------------------- |
| `-q, --question <text>`    | Yes      | The question to ask                                                          |
| `-r, --resource <name...>` | No       | Resource(s) to search; repeatable. If omitted, uses all configured resources |

<<<<<<< HEAD
**Features:**

- Supports `@mentions` in the question: `btca ask -q "@svelte @tailwind How do I style components?"`
- Combine `-r` flags with `@mentions`; duplicates are deduplicated

# **Examples:**

- `btca ask --question '<question>' [--resource <resource>...]`
  - Ask one question and stream the answer.
  - `--resource` can be repeated for multiple resources.
  - Supports @mentions in the question to specify resources.

- `btca chat [--resource <resource>...]`
  - Launch the interactive TUI for multi-turn conversation.
    > > > > > > > a028dc0 (quality of life fixes from old prs)

```bash
# Single resource
btca ask -r svelte -q "How does the $state rune work?"

<<<<<<< HEAD
# Multiple resources
btca ask -r react -r typescript -q "How do I type useState?"

# Using @mentions instead of -r flags
btca ask -q "@svelte @effect How do I integrate Effect with Svelte?"
```

=======

- `btca config model`
  - Show the current provider/model.
- `btca config model --provider <provider> --model <model>`
  - Set provider + model (both required together).

- `btca config resources list`
  - List configured resources.
- `btca config resources add --name <name> --type <type> [--url <url>] [--branch <branch>] [--path <path>] [--notes '<specialNotes>'] [--search-path '<path>']`
  - Add a resource. Type is `git` (default) or `local`.
  - Git resources require `--url <url>`, optional `--branch <branch>` (default: main).
  - Local resources require `--path <path>`.
- `btca config resources remove [--name <name>]`
  - Remove a resource from the config (with confirmation).
    > > > > > > > a028dc0 (quality of life fixes from old prs)

---

### `btca config resources list`

List all configured resources. **Run this first** to see what's available.

```bash
btca config resources list
```

## <<<<<<< HEAD

=======

- `btca ask --resource svelte --question 'How do runes work in Svelte 5?'`
  > > > > > > > a028dc0 (quality of life fixes from old prs)

### `btca config resources add`

<<<<<<< HEAD
Add a new resource. **Ask the user for missing details** if they don't provide them.

```bash
# Git resource (all flags shown)
btca config resources add -n <name> -t git -u <url> -b <branch> [--search-path <path>] [--notes <text>]

# Local resource
btca config resources add -n <name> -t local --path <absolutePath> [--notes <text>]
```

| Flag                    | Required    | Description                                                                          |
| ----------------------- | ----------- | ------------------------------------------------------------------------------------ |
| `-n, --name <name>`     | Yes         | Unique resource name (Camelcase! and alphanumeric + hyphens, must start with letter) |
| `-t, --type <type>`     | Yes         | `git` or `local`                                                                     |
| `-u, --url <url>`       | Yes (git)   | HTTPS git repository URL                                                             |
| `-b, --branch <branch>` | No (git)    | Branch to clone (default: `main`)                                                    |
| `--path <path>`         | Yes (local) | Absolute path to local directory                                                     |
| `--search-path <path>`  | No          | Subdirectory within repo to focus searches on                                        |
| `--notes <text>`        | No          | Hints for the AI about this resource (e.g., "Focus on the docs/ directory")          |

**If user says "add svelte" without details, ask:**

> Which repository URL should I use? Common choice for Svelte docs: `https://github.com/sveltejs/svelte.dev` with `searchPath: apps/svelte.dev`. Should I use that, or do you have a different repo in mind? Ask for each required information if missing! Do not assume!

---

### `btca config resources remove`

Remove a resource.

```bash
btca config resources remove -n <name>
```

---

### `btca config model`

Change the AI model/provider.

```bash
btca config model -p <provider> -m <model>
```

| Flag                  | Required | Description                                       |
| --------------------- | -------- | ------------------------------------------------- |
| `-p, --provider <id>` | Yes      | Provider ID (e.g., `opencode`, `anthropic`)       |
| `-m, --model <id>`    | Yes      | Model ID (e.g., `claude-haiku-4-5`, `big-pickle`) |

**If user says "change the model" without specifying which, ask:**

> Which model would you like to use? Recommended options with `opencode` provider:
>
> - `claude-haiku-4-5` – fast, highly recommended
> - `big-pickle` – free, surprisingly good (default)
> - `minimax-m2.1-free` – very fast, very cheap
> - `kimi-k2` – no reasoning

---

### `btca clear`

Clear all locally cloned git repositories (frees disk space, forces fresh clone on next use).

```bash
btca clear
```

---

### `btca chat`

Start an interactive OpenCode TUI session. Requires `opencode` CLI installed.

```bash
btca chat -r <resource...>
```

---

### `btca serve`

Start btca server as a persistent process (for external integrations).

```bash
btca serve [-p <port>]
```

Default port: 8080. Server runs until `Ctrl+C`.

---

### Global Flags

These apply to all subcommands:

| Flag             | Description                                                     |
| ---------------- | --------------------------------------------------------------- |
| `--server <url>` | Connect to an existing btca server instead of auto-starting one |
| `--port <port>`  | Port for the auto-started server (default: random 3000-6000)    |
| `-v, --version`  | Print version number                                            |

---

## Config Locations

| Location                           | Purpose                                       |
| ---------------------------------- | --------------------------------------------- |
| `~/.config/btca/btca.config.jsonc` | Global config (used when no project config)   |
| `./btca.config.jsonc`              | Project config (overrides global per-project) |

When both exist, resources merge by name (project overrides global).

---

## TUI Quick Reference

If the user wants to use the interactive TUI (`btca` without subcommands):

| Feature   | How to use                                       |
| --------- | ------------------------------------------------ |
| @Mentions | `@svelte How do I...?` – first message needs one |
| `/model`  | Change model                                     |
| `/add`    | Add resource via wizard                          |
| `/clear`  | Clear chat history                               |
| `Escape`  | Cancel streaming (press twice to confirm)        |
| `Ctrl+Q`  | Quit                                             |

---

## Troubleshooting

| Problem                    | Solution                                                                   |
| -------------------------- | -------------------------------------------------------------------------- |
| "No resources configured"  | Run `btca config resources add ...` or check if `btca.config.jsonc` exists |
| "Provider not connected"   | Run `opencode auth` in terminal to configure provider credentials          |
| Stale/corrupted cache      | Run `btca clear` to reset                                                  |
| Deprecated `-t` flag error | Use `-r` instead: `btca ask -r svelte ...`                                 |

---

## Quick Reference

```bash
# Ask a question
btca ask -r <resource> -q "<question>"

# List resources
btca config resources list

# Add git resource
btca config resources add -n <name> -t git -u <url> -b <branch>

# Add local resource
btca config resources add -n <name> -t local --path <absolutePath>

# Remove resource
btca config resources remove -n <name>

# Change model
btca config model -p opencode -m claude-haiku-4-5

# Clear cache
btca clear
```

=======

- `btca ask --resource svelte --resource effect --question 'Compare error handling patterns'`
  > > > > > > > a028dc0 (quality of life fixes from old prs)
